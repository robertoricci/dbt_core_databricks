version: 2
models:
  - name: gold_sales__daily
    tests:
      - dbt_expectations.expect_table_columns_to_match_set:
          column_list: ["order_date","product_name","category","vendor","city","state","sales_channel","total_revenue"]

# unit_tests:
#   - name: test_gold_avg__rating
#     model: gold_avg_rating__daily
#     given:
#       - input: ref('bronze_reviews')  
#         format: csv
#         rows: |
#           id,created_at,product_id,rating
#           1,2018-01-01T00:57:04.845+00:00,1,5
#           2,2018-01-04T00:00:14+00:00,1,4
#           3,2020-01-04T00:00:00+00:00,2,3
#       - input: ref('silver_products')
#         format: csv
#         rows: |
#           id,product_name
#           1,'product1'
#           2,'product2'
#       - input: source('landing', 'reviews')  # ← mock necessário
#         format: csv
#         rows: |
#           id,created_at,product_id,rating
#           1,2018-01-01T00:57:04.845+00:00,1,5
#           2,2018-01-04T00:00:14+00:00,1,4
#           3,2020-01-04T00:00:00+00:00,2,3
#       - input: source('landing', 'products')  # ← mock necessário
#         format: csv
#         rows: |
#           id,title
#           1,'product1'
#           2,'product2'
#     expect:
#       format: csv
#       rows: |
#         review_date,product_id,avg_rating
#         2018-01-01,1,4.5
#         2020-01-04,2,3
